# 🔒 CRMS 客戶管理表單驗證指南

## ✅ 資料型別驗證已實作完成！

### 📋 驗證規則對應資料庫結構

根據資料庫 `Customer` 模型，表單驗證規則如下：

| 欄位 | 資料型別 | 是否必填 | 驗證規則 | 限制 |
|------|----------|----------|----------|------|
| **Name** | `string` | ✅ 必填 | 不可空白 | 最大 100 字元 |
| **Gender** | `string` | ✅ 必填 | 必須為 "Male" 或 "Female" | 大小寫敏感 |
| **Birthday** | `date` | ✅ 必填 | 有效日期，不可未來日期 | 1900-今天 |
| **NationalId** | `string` | ✅ 必填 | 字母數字+連字號底線，唯一值 | 最大 100 字元 |
| **PhoneNumber** | `string` | ❌ 選填 | 電話號碼格式 | 7-20 字元 |
| **CarNumber** | `string` | ❌ 選填 | 字母數字+連字號 | 最大 20 字元 |
| **Address** | `string` | ❌ 選填 | 任意文字 | 最大 500 字元 |
| **CitizenshipId** | `int` | ✅ 必填 | 必須選擇有效國籍 | 來自國籍清單 |
| **Note** | `string` | ❌ 選填 | 任意文字 | 最大 1000 字元 |

## 🔧 實作功能

### ✅ **前端驗證**：
- **即時驗證**：欄位失焦時檢查
- **視覺回饋**：錯誤欄位紅色邊框 + 背景
- **錯誤訊息**：每個欄位下方顯示具體錯誤
- **字元計數**：備註欄位顯示剩餘字元數

### ✅ **資料型別檢查**：
- **字串長度**：防止超過資料庫限制
- **日期格式**：確保正確的日期格式
- **正規表達式**：電話號碼、身分證、車牌格式
- **數值範圍**：國籍 ID 必須 > 0

### ✅ **後端整合**：
- **重複檢查**：身分證號碼唯一性檢查
- **外鍵驗證**：國籍 ID 必須存在於國籍表
- **錯誤處理**：API 錯誤回饋到表單

## 📝 驗證詳細說明

### **Name 姓名**
```typescript
- 必填欄位
- 不可為空白或只有空格
- 最大長度 100 字元
- 對應資料庫: varchar, not null
```

### **Gender 性別**
```typescript
- 必填欄位
- 必須完全符合 "Male" 或 "Female"
- 大小寫敏感
- 對應資料庫: varchar, not null
```

### **Birthday 生日**
```typescript
- 必填欄位
- 必須為有效日期
- 不可選擇未來日期
- 年份限制: 1900-今年
- 格式: YYYY-MM-DD
- 對應資料庫: datetime, not null, indexed
```

### **NationalId 身分證號**
```typescript
- 必填欄位
- 不可為空白
- 格式: 字母、數字、連字號、底線
- 最大長度 100 字元
- 後端檢查唯一性
- 對應資料庫: varchar(100), not null, unique index
```

### **PhoneNumber 電話號碼**
```typescript
- 選填欄位
- 格式: +國碼-區碼-號碼 或 純數字
- 允許括號、空格、連字號
- 長度: 7-20 字元
- 對應資料庫: varchar, nullable
```

### **CarNumber 車牌號碼**
```typescript
- 選填欄位
- 格式: 字母、數字、連字號
- 最大長度 20 字元
- 對應資料庫: varchar, nullable
```

### **Address 地址**
```typescript
- 選填欄位
- 任意文字內容
- 最大長度 500 字元
- 對應資料庫: varchar, nullable
```

### **CitizenshipId 國籍**
```typescript
- 必填欄位
- 必須 > 0
- 必須存在於國籍清單中
- 預設選擇第一個可用國籍
- 對應資料庫: int, not null, foreign key
```

### **Note 備註**
```typescript
- 選填欄位
- 任意文字內容
- 最大長度 1000 字元
- 即時顯示字元計數
- 對應資料庫: varchar, nullable
```

## 🎯 使用者體驗改善

### **視覺指示**：
- ✅ 必填欄位標示 `*`
- 🔴 錯誤欄位紅色邊框 + 背景
- 📝 欄位說明和格式提示
- 📊 字元計數器

### **表單提交**：
- 提交前完整驗證
- 防止無效資料提交
- API 錯誤回饋處理
- 成功後自動重置表單

### **錯誤處理**：
- 具體的錯誤訊息
- 多語言友好的錯誤文字
- 網路錯誤處理
- 重複資料提示

## 🔧 開發者注意事項

1. **資料庫同步**：確保前端驗證規則與後端 GORM 模型一致
2. **國籍資料**：系統預載 249 個國家/地區資料
3. **日期格式**：前端使用 YYYY-MM-DD，後端轉換為 time.Time
4. **唯一性檢查**：身分證號碼在後端進行唯一性驗證
5. **錯誤回饋**：API 錯誤會自動對應到相關表單欄位

現在客戶管理表單已完全符合資料庫結構要求！🎉